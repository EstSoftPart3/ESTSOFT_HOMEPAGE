<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.eep.mapper.FoBoardMapper">
	
	<!-- 메인페이지 공지사항 최신 5개 표시 -->
	<select id="mainNoticeList" resultType="hashMap">
		<![CDATA[ 
        SELECT
        		BRD_SQ 																		   AS 		brdSq
              , IF(LENGTH(BRD_TTL) <= 15, LEFT(BRD_TTL, 15), CONCAT(LEFT(BRD_TTL, 15), '..'))  AS 		brdTtl
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d') 									   	   AS 		brdRegDt
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'NT'
 		ORDER BY 
 				BRD_SQ DESC LIMIT 5
 		 ]]>
    </select>
    
	<!-- 메인페이지 기술지원 최신 5개 표시 -->
	<select id="mainTechnologyList" resultType="hashMap">
		<![CDATA[
        SELECT
        		BRD_SQ 																		   AS 		brdSq
              , IF(LENGTH(BRD_TTL) <= 15, LEFT(BRD_TTL, 15), CONCAT(LEFT(BRD_TTL, 15), '..'))  AS 		brdTtl
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d') 									   	   AS 		brdRegDt
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'TL'
 		ORDER BY 
 				BRD_SQ DESC LIMIT 5
 		]]>
    </select>
    
	<!-- 메인페이지 교육일정 최신 5개 표시 -->
	<select id="mainEductaionList" resultType="hashMap">
		<![CDATA[
        SELECT
        		BRD_SQ 																		   AS 		brdSq
              , IF(LENGTH(BRD_TTL) <= 15, LEFT(BRD_TTL, 15), CONCAT(LEFT(BRD_TTL, 15), '..'))  AS 		brdTtl
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d') 									   	   AS 		brdRegDt
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'ED'
 		ORDER BY 
 				BRD_SQ DESC LIMIT 5
 		]]>
    </select>
    
    <!-- 공지시항 게시판 Mapper -->
    
    <!-- 공지사항 목록 및 조회 -->
	<select id="noticeBoardListData" resultType="hashMap" parameterType="hashMap">
	
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'NT' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWC" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		
 		ORDER BY 
 				BRD_SQ DESC
 		LIMIT 
 				#{start}, #{end}

    </select>
    
     <!-- 공지사항 게시판 개수 -->
	<select id="noticeBoardListCountData" resultType="int" parameterType="hashMap">
	
        SELECT
				COUNT(BRD_SQ)
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'NT' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWC" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>

    </select>

	<!-- 공지사항 등록 -->
	<insert id="noticeBoardInsertData" parameterType="hashMap">
    	INSERT INTO TB_EEP_BRD_M
        (
			 EMPLY_SQ
			,BRD_TYP_CD
			,BRD_TTL
			,BRD_CNTNT
			,BRD_WRTR
			,BRD_REG_DT
			,USE_YN 
			,DEL_YN
       	) 
        VALUES
        (
			 #{emplySq}
			,'NT'
			,#{brdTtl}
			,#{brdCntnt}
			,#{brdWrtr}
			,default
			,default
			,default
        )
	</insert>
    
    <!-- 공지시항 상세 -->
    <select id="noticeBoardDetailData" resultType="hashMap">
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
         		1=1 AND BRD_TYP_CD = 'NT' AND BRD_SQ = #{brdSq}
    </select>
    
    <!-- 공지시항 수정 -->
    <update id="noticeBoardUpdateData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 BRD_TTL        	= 	#{brdTtl}
			,BRD_CNTNT     		= 	#{brdCntnt}
			,BRD_UPDT_DT      	= 	NOW()
   		WHERE
         	1=1 AND BRD_TYP_CD = 'NT' AND BRD_SQ = #{brdSq}
	</update>
	
	<!-- 공지시항 삭제 -->
    <update id="noticeBoardDeleteData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 DEL_YN	= 'Y'
			,USE_YN	= 'N'
   		WHERE
         	1=1 AND BRD_TYP_CD = 'NT' AND BRD_SQ = #{brdSq}
	</update>
	
	<!-- 교육 게시판 Mapper -->
	
	<!-- 교육 목록 및 조회 -->
	<select id="educationBoardListData" resultType="hashMap" parameterType="hashMap">
	
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'ED' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "I" and searchOption != null'>
          			AND BRD_TCHR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWCI" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_TCHR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
 		ORDER BY 
 				BRD_SQ DESC
 		LIMIT 
 				#{start}, #{end}

    </select>

	<!-- 교육 게시판 개수 -->
	<select id="educationBoardListCountData" resultType="int" parameterType="hashMap">
	
        SELECT
				COUNT(BRD_SQ)
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'ED' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "I" and searchOption != null'>
          			AND BRD_TCHR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWCI" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_TCHR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>

    </select>

	<!-- 교육 등록 -->
	<insert id="educationBoardInsertData" parameterType="hashMap">
    	INSERT INTO TB_EEP_BRD_M
        (
			 EMPLY_SQ
			,BRD_TYP_CD
			,BRD_TTL
			,BRD_CNTNT
			,BRD_WRTR
			,BRD_TCHR
			,BRD_EDU_DT
			,BRD_REG_DT
			,USE_YN 
			,DEL_YN
       	) 
        VALUES
        (
			 #{emplySq}
			,'ED'
			,#{brdTtl}
			,#{brdCntnt}
			,#{brdWrtr}
			,#{brdTchr}
			,#{brdEduDt}
			,default
			,default
			,default
        )
	</insert>
    
    <!-- 교육 상세 -->
    <select id="educationBoardDetailData" resultType="hashMap">
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
         		1=1 AND BRD_TYP_CD = 'ED' AND BRD_SQ = #{brdSq}
    </select>
    
    <!-- 교육 수정 -->
    <update id="educationBoardUpdateData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 BRD_TTL        	= 	#{brdTtl}
			,BRD_CNTNT     		= 	#{brdCntnt}
			,BRD_TCHR 			= 	#{brdTchr}
			,BRD_EDU_DT 		= 	#{brdEduDt}
			,BRD_UPDT_DT      	= 	NOW()
   		WHERE
         	1=1 AND BRD_TYP_CD = 'ED' AND BRD_SQ = #{brdSq}
	</update>
	
	<!-- 교육 삭제 -->
    <update id="educationBoardDeleteData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 DEL_YN	= 'Y'
			,USE_YN	= 'N'
   		WHERE
         	1=1 AND BRD_TYP_CD = 'ED' AND BRD_SQ = #{brdSq}
	</update>
	
	 <!-- 쟈유 게시판 Mapper -->
    
    <!-- 자유 게시판 목록 및 조회 -->
	<select id="freedomBoardListData" resultType="hashMap" parameterType="hashMap">
	
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'FD' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWC" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		
 		ORDER BY 
 				BRD_RE_REF DESC, BRD_RE_ORD ASC
 		LIMIT 
 				#{start}, #{end}

    </select>
    
    <!-- 자유 게시판 개수 -->
	<select id="freedomBoardListCountData" resultType="int" parameterType="hashMap">
	
        SELECT
				COUNT(BRD_SQ)
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'FD' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWC" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>

    </select>
    
	<!-- 자유 게시판 원본 등록 -->
	<insert id="freedomBoardInsertData" parameterType="hashMap">

    	INSERT INTO TB_EEP_BRD_M
        (
			 EMPLY_SQ
			,BRD_TYP_CD
			,BRD_TTL
			,BRD_CNTNT
			,BRD_WRTR
			,BRD_RE_REF
			,BRD_RE_LEV
			,BRD_RE_ORD
			,BRD_REG_DT
			,USE_YN 
			,DEL_YN
       	) 
        VALUES
        (
			 #{emplySq}
			,'FD'
			,#{brdTtl}
			,#{brdCntnt}
			,#{brdWrtr}
			,0
			,0
			,0
			,default
			,default
			,default
        )
	</insert>
	
	<!-- 원본 저장 후  BRD_RE_REF 컬럼에 현재 번호 조회해서 넣어주는 쿼리-->
    <insert id="freedomBoardInsertUpdateData" parameterType="hashMap">
    	
		<selectKey resultType="int" keyProperty="brdReRep" order="BEFORE">
            
            SELECT IFNULL(MAX(BRD_SQ), 0)
            FROM TB_EEP_BRD_M
              
        </selectKey>
    
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			BRD_RE_REF = #{brdReRep}
   		WHERE
         	1=1 AND BRD_TYP_CD = 'FD' AND BRD_SQ = #{brdReRep}
	</insert>
    
    <!-- 자유게시판 상세 -->
    <select id="freedomBoardDetailData" resultType="hashMap">
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
         		1=1 AND BRD_TYP_CD = 'FD' AND BRD_SQ = #{brdSq}
    </select>
    
    <!-- 자유 게시판 답변 업데이트 등록 -->
    <delete id="freedomBoardReplyInsertUpdateData" parameterType="hashMap">
    
        UPDATE TB_EEP_BRD_M
           SET BRD_RE_ORD = BRD_RE_ORD + 1
         WHERE BRD_RE_REF = #{brdReRep} 
           AND BRD_RE_ORD > #{brdReOrd}
     
    </delete>
    
    <!-- 자유 게시판 답변 등록 -->
   	<insert id="freedomBoardReplyInsertData" parameterType="hashMap">

    	INSERT INTO TB_EEP_BRD_M
        (
			 EMPLY_SQ
			,BRD_TYP_CD
			,BRD_TTL
			,BRD_CNTNT
			,BRD_WRTR
			,BRD_RE_REF
			,BRD_RE_LEV
			,BRD_RE_ORD
			,BRD_REG_DT
			,USE_YN 
			,DEL_YN
       	) 
        VALUES
        (
			 #{emplySq}
			,'FD'
			,#{brdTtl}
			,#{brdCntnt}
			,#{brdWrtr}
			,#{brdReRep}
			,#{brdReLev} + 1
			,#{brdReOrd} + 1
			,default
			,default
			,default
        )
	</insert>
    
    <!-- 자유 게시판 수정 -->
    <update id="freedomBoardUpdateData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 BRD_TTL        	= 	#{brdTtl}
			,BRD_CNTNT     		= 	#{brdCntnt}
			,BRD_UPDT_DT      	= 	NOW()
   		WHERE
         	1=1 AND BRD_TYP_CD = 'FD' AND BRD_SQ = #{brdSq}
	</update>
	
	<!-- 자유 게시판 삭제 -->
    <update id="freedomBoardDeleteData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 DEL_YN	= 'Y'
			,USE_YN	= 'N'
   		WHERE
         	1=1 AND BRD_TYP_CD = 'FD' AND BRD_SQ = #{brdSq}
	</update>
	
	<!-- 기술문의 게시판 Mapper -->
    
    <!-- 기술문의 게시판 목록 및 조회 -->
	<select id="technologyBoardListData" resultType="hashMap" parameterType="hashMap">
	
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'TL' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWC" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		
 		ORDER BY 
 				BRD_RE_REF DESC, BRD_RE_ORD ASC
 		LIMIT 
 				#{start}, #{end}

    </select>
    
    <!-- 기술문의 게시판 개수 -->
	<select id="technologyBoardListCountData" resultType="int" parameterType="hashMap">
	
        SELECT
				COUNT(BRD_SQ)
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
 				BRD_TYP_CD = 'TL' AND USE_YN = 'Y' AND DEL_YN = 'N'
 				
 				<if test='searchOption == "T" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
           		<if test='searchOption == "W" and searchOption != null'>
          			AND BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "C" and searchOption != null'>
          			AND BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>
          		<if test='searchOption == "TWC" and searchOption != null'>
          			AND BRD_TTL LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_WRTR LIKE CONCAT('%',#{searchKeyword},'%')
          			OR BRD_CNTNT LIKE CONCAT('%',#{searchKeyword},'%')
          		</if>

    </select>
    
	<!-- 자유 게시판 원본 등록 -->
	<insert id="technologyBoardInsertData" parameterType="hashMap">

    	INSERT INTO TB_EEP_BRD_M
        (
			 EMPLY_SQ
			,BRD_TYP_CD
			,BRD_TTL
			,BRD_CNTNT
			,BRD_WRTR
			,BRD_RE_REF
			,BRD_RE_LEV
			,BRD_RE_ORD
			,BRD_REG_DT
			,USE_YN 
			,DEL_YN
       	) 
        VALUES
        (
			 #{emplySq}
			,'TL'
			,#{brdTtl}
			,#{brdCntnt}
			,#{brdWrtr}
			,0
			,0
			,0
			,default
			,default
			,default
        )
	</insert>
	
	<!-- 원본 저장 후  BRD_RE_REF 컬럼에 현재 번호 조회해서 넣어주는 쿼리-->
    <insert id="technologyBoardInsertUpdateData" parameterType="hashMap">
    	
		<selectKey resultType="int" keyProperty="brdReRep" order="BEFORE">
            
            SELECT IFNULL(MAX(BRD_SQ), 0)
            FROM TB_EEP_BRD_M
              
        </selectKey>
    
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			BRD_RE_REF = #{brdReRep}
   		WHERE
         	1=1 AND BRD_TYP_CD = 'TL' AND BRD_SQ = #{brdReRep}
	</insert>
    
    <!-- 기술문의 게시판 상세 -->
    <select id="technologyBoardDetailData" resultType="hashMap">
        SELECT
        		BRD_SQ 										AS 		brdSq
              , EMPLY_SQ 									AS 		emplySq
              , BRD_TYP_CD 									AS 		brdTypCd
              , BRD_RE_REF 									AS 		brdReRep
              , BRD_RE_LEV 									AS 		brdReLev
              , BRD_RE_ORD 									AS 		brdReOrd
              , BRD_TTL 									AS 		brdTtl
              , BRD_CNTNT 									AS 		brdCntnt
              , CASE WHEN CHAR_LENGTH(BRD_WRTR) > 2 THEN CONCAT(
            		 SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 2, '*')
            		,SUBSTRING(BRD_WRTR, CHAR_LENGTH(BRD_WRTR), CHAR_LENGTH(BRD_WRTR))
        		)ELSE CONCAT(
            		SUBSTRING(BRD_WRTR, 1, 1)
            		,LPAD('*', CHAR_LENGTH(BRD_WRTR) - 1, '*')
        		)END 										AS 		brdWrtr
              , BRD_TCHR 									AS 		brdTchr
              , BRD_EDU_DT 									AS 		brdEduDt
              , DATE_FORMAT(BRD_REG_DT, '%Y-%m-%d %H:%i') 	AS 		brdRegDt
              , DATE_FORMAT(BRD_UPDT_DT, '%Y-%m-%d %H:%i') 	AS 		brdUpdtDt
              , USE_YN 										AS 		useYn
              , DEL_YN 										AS 		delYn
 		FROM 
 				TB_EEP_BRD_M 
 		WHERE
         		1=1 AND BRD_TYP_CD = 'TL' AND BRD_SQ = #{brdSq}
    </select>
    
    <!-- 기술문의 게시판 답변 업데이트 등록 -->
    <delete id="technologyBoardReplyInsertUpdateData" parameterType="hashMap">
    
        UPDATE TB_EEP_BRD_M
           SET BRD_RE_ORD = BRD_RE_ORD + 1
         WHERE BRD_RE_REF = #{brdReRep} 
           AND BRD_RE_ORD > #{brdReOrd}
     
    </delete>
    
    <!-- 기술문의 게시판 답변 등록 -->
   	<insert id="technologyBoardReplyInsertData" parameterType="hashMap">

    	INSERT INTO TB_EEP_BRD_M
        (
			 EMPLY_SQ
			,BRD_TYP_CD
			,BRD_TTL
			,BRD_CNTNT
			,BRD_WRTR
			,BRD_RE_REF
			,BRD_RE_LEV
			,BRD_RE_ORD
			,BRD_REG_DT
			,USE_YN 
			,DEL_YN
       	) 
        VALUES
        (
			 #{emplySq}
			,'TL'
			,#{brdTtl}
			,#{brdCntnt}
			,#{brdWrtr}
			,#{brdReRep}
			,#{brdReLev} + 1
			,#{brdReOrd} + 1
			,default
			,default
			,default
        )
	</insert>
    
    <!-- 기술문의 게시판 수정 -->
    <update id="technologyBoardUpdateData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 BRD_TTL        	= 	#{brdTtl}
			,BRD_CNTNT     		= 	#{brdCntnt}
			,BRD_UPDT_DT      	= 	NOW()
   		WHERE
         	1=1 AND BRD_TYP_CD = 'TL' AND BRD_SQ = #{brdSq}
	</update>
	
	<!-- 기술문의 게시판 삭제 -->
    <update id="technologyBoardDeleteData" parameterType="hashMap">
   		UPDATE 
   			TB_EEP_BRD_M
		SET
			 DEL_YN	= 'Y'
			,USE_YN	= 'N'
   		WHERE
         	1=1 AND BRD_TYP_CD = 'TL' AND BRD_SQ = #{brdSq}
	</update>
	
</mapper>